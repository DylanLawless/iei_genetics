# B cell ----
lookup <- c(
  "decreased numbers of b cells and switched memory b cells" = "decreased",
  "normal" = "normal",
  "normal to low" = "borderline",
  "low, decreasing" = "low",
  "nl to low" = "borderline",
  "normal numbers" = "normal",
  "increased" = "high",
  "impaired memory b cell development" = "defective",
  "nl number, decreased memory and switched b cells" = "borderline",
  "very low" = "low",
  "high" = "high",
  "normal, transitional b cell predominance" = "normal",
  "nl number" = "normal",
  "low/variable" = "low",
  "no memory b cells" = "low",
  "low switched memory b cells" = "low",
  "normal numbers of total b cells and subsets" = "normal",
  "sigm+, igd+ cells present, absent sigg+, iga+ and ige+ cells" =  "variable",
  "nl number, poor antibody and memory responses" = "borderline",
  "variable" = "variable",
  "decreased or normal" = "borderline",
  "b cell lymphopenia" = "low",
  "normal slightly reduced" = "borderline",
  "normal b cell numbers, low switched memory b cells" = "borderline",
  "decreased" = "decreased",
  "normal with low memory cells" = "borderline",
  "nl/low" = "borderline",
  "low" = "low",
  "low to normal" = "borderline",
  "hi naïve/transitional, low memory" =  "variable",
  "low class switched b cells" = "low",
  "low, low cd27+ memory b cells poor peripheral b cell tolerance." = "low",
  "defective" = "defective",
  "low b cells" = "low",
  "slightly decreased" = "borderline",
  "normal or low" = "borderline",
  "declining" = "decreased",
  "low or normal" = "borderline",
  "nl number, poor function" = "borderline",
  "normal count, poor function" = "borderline",
  "normal, low memory and isotype switched b cells" = "borderline",
  "normal b cell numbers, but low switched memory. dysregulated germinal centers" = "borderline",
  "abnormal b cell development\r\n(decreased bm b precursors; \r\nhi cd21lo b; decreased memory b cells). decreased response to cd40" = "defective",
  "increased memory b cells" = "high",
  "normal to high" = "borderline",
  "most patients died early, no data" = NA_character_,
  "normal numbers of b cells, low memory b cells" = "borderline",
  "reduced" = "low",
  "not assessed" = NA_character_,
  "variably decreased switched memory b cells" = "decreased",
  "normal numbers in childhood usually" = "normal",
  "low or normal numbers of b cells" = "borderline",
  "low, low switched memory b cells" = "low",
  "b cell deficiency variable" = "variable",
  "low number" = "low",
  "immature b cells" = "immature",
  "variably reduced" = "low",
  "low switched memory" = "low",
  "decreased switched memory b cells" = "decreased",
  "normal b cell numbers, impaired bcr activation, low memory and isotype switched b cells" = "variable",
  "low b and memory b cells" = "low",
  "increased immature b cells, reduced memory b cells and increased transitional b cells" =  "variable",
  "normal but diminished memory" = "borderline",
  "low b cells, switched and non-switched" = "low",
  "low memory b cells" = "low",
  "normal b cell numbers, decreased  switched memory b cells, and  altered b cell phenotype" = "borderline",
  "low memory b cells, high cd5 b cells" = "borderline",
  "mild pancytopenia" = NA_character_,
  "poor activation, proliferation, motility" = NA_character_,
  "normal,  decreased memory b cells" = "borderline",
  "not reported" = NA_character_,
  "b cell lymphopenia\r\nhi  bm plasmablasts" = "low",
  "reduced memory b cells" = "low",
  "variably low switched memory b cells" = "low",
  "slightly low" = "borderline",
  "normal b cell numbers but low memory" = "borderline",
  "normal (decreased memory b cells)" = "borderline",
  "decreased b. b cell development arrested at pro to pre–b stage" = "decreased",
  "low switched and non-switched b cells" = "low",
  "normal,  reduced switched and non-switched memory b cells, baff expression increased" = "borderline",
  "normal numbers of b cells with low memory" = "borderline",
  "nl number, low memory b cells" = "borderline",
  "altered maturation" = "abnormal",
  "nl numbers, low memory b cells" = "borderline",
  "normal, low memory b cells" = "borderline",
  "normal b cell count with low memory b cells and plasmablasts" = "borderline",
  "high plasmablasts" = "high",
  "normal or reduced memory b cells" = "borderline",
  "normal or decreased" = "borderline",
  "decreased memory b cells" = "decreased"
)

df <- df %>%
  mutate(B_cell_count_clean = `B cell count` %>%
           tolower() %>%
           str_trim() %>%
           recode(!!!lookup))
